# == Scenario
# 

State {
  system : chan ;
  slave : chan ;
  ptyer : chan ;
}

Components {
  System    "system"        ;
  Slave     "slave"         ;
  Ptyer     "ptyer"         ;
}

Messages {

  # slave <-> monitor 
  LoginReq(str);
  LoginRes(num);

  CreatePtyerReq(str);
  CreatePtyerRes(str);

  PubkeyReq();
  PubkeyRes();

  KeysignReq(str);
  KeysignRes(str);


  # monitor <-> system
  SysLoginReq(str);
  SysLoginRes(str);

  SysPubkeyReq();
  SysPubkeyRes();

  SysKeysignReq(str);
  SysKeysignRes(str);

  OpenPty

}

Init {
  system := spwan(System);
  slave := spawn(Slave);
}

Exchange(c) {
  Tab {
    Wget(url) {
      f := call("wget.py", url);
      send(c, HTML(url, f));
    }
    Display(bitmap) {
      # TODO check that this is from cur tab
      send(screen, Display(bitmap));
    }
  }

  UserInput {
    Input(i) {
      send(curtab, Input(i));
    }
  }
}